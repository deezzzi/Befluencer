  <div class="mk-setup-wrapper" [class.preview-mode]="activeStep===steps.length-1">
    <div class="wizard-card" role="form" aria-labelledby="mk-stepper">
  <!-- Stepper with connectors (hidden on preview step) -->
  <ol *ngIf="activeStep !== steps.length-1" id="mk-stepper" class="steps" aria-label="Setup steps">
        <li *ngFor="let s of steps; let i = index"
            [class.active]="i===activeStep"
            [class.completed]="i < activeStep"
            (click)="jump(i)"
            [attr.aria-current]="i===activeStep ? 'step' : null"
            [class.clickable]="i < activeStep">
          <div class="row">
            <span class="circle" aria-hidden="true">{{ i+1 }}</span>
            <span class="label">{{ s.label }}</span>
            <span class="connector" aria-hidden="true"></span>
            <span *ngIf="i < steps.length-1" class="connector-space" aria-hidden="true"></span>
          </div>
            <div class="desc" [innerHTML]="s.desc"></div>
        </li>
      </ol>

      <!-- Heading line (replaced on preview) -->
      <ng-container *ngIf="activeStep !== steps.length-1; else previewHeader">
        <div class="section-bar">
          <h2 class="section-title">{{ steps[activeStep].label }}</h2>
          <div class="rule" aria-hidden="true"></div>
        </div>
        <div class="preview-row">
          <a class="preview-link" href="#" (click)="openPreview($event)">Preview <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 5c7.633 0 10 7 10 7s-2.367 7-10 7-10-7-10-7 2.367-7 10-7Z"/></svg></a>
        </div>
      </ng-container>
      <ng-template #previewHeader>
        <!-- <div class="preview-header">
          <h1 class="preview-title">Media Kit Preview</h1>
        </div> -->
      </ng-template>

  <!-- Step 1 form -->
  <div *ngIf="activeStep===0" class="step-content basic-info-step">
        <div class="profile-intro">
          <div class="avatar" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="#444" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20c1.4-3.2 4.3-5 8-5s6.6 1.8 8 5"/></svg>

            <!-- <svg width="28" height="28" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M30 5C16.1925 5 5 16.1925 5 30C5 43.8075 16.1925 55 30 55C43.8075 55 55 43.8075 55 30C55 16.1925 43.8075 5 30 5Z" stroke="#1E1E1E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M10.6777 45.865C10.6777 45.865 16.2502 38.75 30.0002 38.75C43.7502 38.75 49.3252 45.865 49.3252 45.865M30.0002 30C31.9894 30 33.897 29.2098 35.3035 27.8033C36.7101 26.3968 37.5002 24.4891 37.5002 22.5C37.5002 20.5109 36.7101 18.6032 35.3035 17.1967C33.897 15.7902 31.9894 15 30.0002 15C28.0111 15 26.1035 15.7902 24.6969 17.1967C23.2904 18.6032 22.5002 20.5109 22.5002 22.5C22.5002 24.4891 23.2904 26.3968 24.6969 27.8033C26.1035 29.2098 28.0111 30 30.0002 30Z" stroke="#1E1E1E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg> -->

<svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M30 5C16.1925 5 5 16.1925 5 30C5 43.8075 16.1925 55 30 55C43.8075 55 55 43.8075 55 30C55 16.1925 43.8075 5 30 5Z" stroke="#1E1E1E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M10.6777 45.865C10.6777 45.865 16.2502 38.75 30.0002 38.75C43.7502 38.75 49.3252 45.865 49.3252 45.865M30.0002 30C31.9894 30 33.897 29.2098 35.3035 27.8033C36.7101 26.3968 37.5002 24.4891 37.5002 22.5C37.5002 20.5109 36.7101 18.6032 35.3035 17.1967C33.897 15.7902 31.9894 15 30.0002 15C28.0111 15 26.1035 15.7902 24.6969 17.1967C23.2904 18.6032 22.5002 20.5109 22.5002 22.5C22.5002 24.4891 23.2904 26.3968 24.6969 27.8033C26.1035 29.2098 28.0111 30 30.0002 30Z" stroke="#1E1E1E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

          </div>
          <div class="id-block"> 
            <div class="name">{{ (form.value.firstName || '').trim() }} {{ (form.value.lastName || '').trim() }}</div>
            <div class="role">Creator</div>
          </div>
        </div>
        <form [formGroup]="form" class="form-grid" (ngSubmit)="next()">
          <label class="field">
            <span>First Name *</span>
            <input formControlName="firstName" type="text" placeholder="John" />
            <small class="err" *ngIf="submitted && form.controls.firstName.invalid">Required</small>
          </label>
          <label class="field">
            <span>Location *</span>
            <div class="input-icon">
              <input formControlName="location" type="text" placeholder="Choose location" />
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.72 16.64C6.97461 16.5657 7.24829 16.5957 7.48083 16.7232C7.71338 16.8507 7.88574 17.0654 7.96 17.32C8.03426 17.5746 8.00434 17.8483 7.87681 18.0808C7.74929 18.3134 7.53461 18.4857 7.28 18.56C6.78 18.706 6.42 18.86 6.189 19C6.427 19.143 6.803 19.303 7.325 19.452C8.48 19.782 10.133 20 12 20C13.867 20 15.52 19.782 16.675 19.452C17.198 19.303 17.573 19.143 17.811 19C17.581 18.86 17.221 18.706 16.721 18.56C16.4704 18.4825 16.2603 18.3096 16.136 18.0786C16.0117 17.8476 15.9831 17.577 16.0564 17.3251C16.1298 17.0733 16.2991 16.8603 16.528 16.7321C16.7569 16.604 17.0269 16.5709 17.28 16.64C17.948 16.835 18.56 17.085 19.03 17.406C19.465 17.705 20 18.226 20 19C20 19.783 19.452 20.308 19.01 20.607C18.532 20.929 17.907 21.18 17.224 21.375C15.846 21.77 14 22 12 22C10 22 8.154 21.77 6.776 21.375C6.093 21.18 5.468 20.929 4.99 20.607C4.548 20.307 4 19.783 4 19C4 18.226 4.535 17.705 4.97 17.406C5.44 17.085 6.052 16.835 6.72 16.64ZM12 7.5C10.46 7.5 9.498 9.167 10.268 10.5C10.625 11.119 11.285 11.5 12 11.5C13.54 11.5 14.502 9.833 13.732 8.5C13.5565 8.19597 13.304 7.9435 13 7.76796C12.6959 7.59243 12.3511 7.50001 12 7.5Z" fill="#ABABAB"/>
<path opacity="0.3" d="M12 2C13.9891 2 15.8968 2.79018 17.3033 4.1967C18.7098 5.60322 19.5 7.51088 19.5 9.5C19.5 12.068 18.1 14.156 16.65 15.64C16.0736 16.2239 15.4542 16.7638 14.797 17.255C14.203 17.701 12.845 18.537 12.845 18.537C12.5874 18.6834 12.2963 18.7604 12 18.7604C11.7037 18.7604 11.4126 18.6834 11.155 18.537C10.4811 18.1462 9.82938 17.7182 9.203 17.255C8.5458 16.7638 7.9264 16.2239 7.35 15.64C5.9 14.156 4.5 12.068 4.5 9.5C4.5 7.51088 5.29018 5.60322 6.6967 4.1967C8.10322 2.79018 10.0109 2 12 2Z" fill="#ABABAB"/>
</svg>
            </div>
            <small class="err" *ngIf="submitted && form.controls.location.invalid">Required</small>
          </label>
          <label class="field">
            <span>Last Name *</span>
            <input formControlName="lastName" type="text" placeholder="Doe" />
            <small class="err" *ngIf="submitted && form.controls.lastName.invalid">Required</small>
          </label>
          <label class="field">
            <span>Audience Base</span>
            <div class="dropdown" [class.open]="openAudience">
              <div class="input-icon" (click)="toggleAudience()">
                <input formControlName="audienceBase" type="text" placeholder="Select area" readonly />
                <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m6 9 6 6 6-6"/></svg>
              </div>
              <ul class="dropdown-panel" *ngIf="openAudience">
                <li *ngFor="let c of countries" (mousedown)="selectAudience(c)">{{ c }}</li>
              </ul>
            </div>
          </label>
          <label class="field">
            <span>Stage Name/Alias</span>
            <input formControlName="alias" type="text" placeholder="Doe" />
          </label>    
          <label class="field">
            <span>Language(s)</span>
            <div class="dropdown" [class.open]="openLanguages">
              <div class="input-icon" (click)="toggleLanguages()">
                <input formControlName="languages" type="text" placeholder="Select language" readonly />
                <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m6 9 6 6 6-6"/></svg>

          
              </div>
              <ul class="dropdown-panel" *ngIf="openLanguages">
                <li *ngFor="let l of languagesList" (mousedown)="selectLanguage(l)">{{ l }}</li>
              </ul>
            </div>
          </label>
          <label class="field span">
            <span>Bio</span>
            <textarea class="bio-input" formControlName="bio" rows="1" placeholder="Enter Text"></textarea>
          </label>
        </form>
      </div>

      <!-- Step 2: Socials & Stats -->
      <div *ngIf="activeStep===1" class="socials-step">
        <div class="platform-grid" role="list">
          <div class="platform-card" *ngFor="let p of platforms" role="listitem" [class.connected]="p.connected">
            <div class="actions-row">
              <button
                type="button"
                class="connect-btn"
                [class.connecting]="p.connecting"
                [disabled]="p.connecting"
                [attr.aria-busy]="p.connecting || null"
                (click)="onConnectClick(p)"
                [attr.aria-pressed]="p.connected"
              >
                <span *ngIf="!p.connected && !p.connecting">Connect</span>
                <span *ngIf="p.connected">Connected</span>
                <span *ngIf="p.connecting">Connecting</span>
                <!-- Show chain icon when idle -->
                <svg *ngIf="!p.connecting && !p.connected" class="link-icon" width="15" height="16" viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <g clip-path="url(#clip0_connect_icon)">
                    <path d="M2.82063 12.2126C4.39063 13.7076 6.26 13.1095 7.00813 12.5038C7.39438 12.1907 7.56875 11.9882 7.71812 11.8382C8.24125 11.3526 8.20812 10.8663 7.86812 10.4776C7.73125 10.322 6.85813 9.4832 6.02063 8.6232C5.58688 8.18945 5.28812 7.8832 5.03187 7.6357C4.69 7.29445 4.39063 6.9032 3.94188 6.91445C3.53063 6.91445 3.23188 7.27695 2.8575 7.65133C2.4275 8.08133 2.11 8.6232 1.99813 9.10945C1.66125 10.5301 2.185 11.5395 2.82063 12.2126ZM2.82063 12.2126L1.25 13.7826M12.1794 2.85508C10.6087 1.35883 8.74562 1.96758 7.99812 2.57383C7.61062 2.88758 7.43688 3.09008 7.28688 3.24008C6.76375 3.72633 6.79688 4.21258 7.1375 4.60133C7.18625 4.65758 7.33125 4.80133 7.53438 5.00383M12.1794 2.85508C12.815 3.5282 13.3456 4.54883 13.0087 5.9707C12.8962 6.45695 12.5787 6.99883 12.1487 7.42945C11.775 7.8032 11.4756 8.16633 11.0644 8.16633C10.6156 8.17758 10.3831 7.85258 10.04 7.51133M12.1794 2.85508L13.75 1.2832M7.53438 5.00383C7.8975 5.3632 8.44875 5.90508 8.985 6.45633C9.41875 6.89008 9.78375 7.26383 10.04 7.5107L9.06375 8.4632M7.53438 5.00383L6.57 5.97383" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </g>
                  <defs>
                    <clipPath id="clip0_connect_icon">
                      <rect width="15" height="15" fill="white" transform="translate(0 0.0332031)"/>
                    </clipPath>
                  </defs>
                </svg>
                <!-- Check icon when connected -->
                <svg *ngIf="p.connected && !p.connecting" class="check-icon" width="15" height="16" viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3.125 7.53369L6.25 10.6587L12.5 4.40869" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <!-- Loading icon while connecting (provided SVG) -->
                <svg *ngIf="p.connecting" class="loading-icon" width="15" height="16" viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                  <path opacity="0.5" d="M7.5 1.28369C6.26387 1.28369 5.0555 1.65025 4.02769 2.33701C2.99988 3.02377 2.1988 3.99988 1.72576 5.14192C1.25271 6.28396 1.12894 7.54062 1.37009 8.75301C1.61125 9.96539 2.20651 11.079 3.08059 11.9531C3.95466 12.8272 5.06831 13.4224 6.28069 13.6636C7.49307 13.9048 8.74974 13.781 9.89178 13.3079C11.0338 12.8349 12.0099 12.0338 12.6967 11.006C13.3834 9.9782 13.75 8.76982 13.75 7.53369C13.75 6.71293 13.5883 5.9002 13.2743 5.14192C12.9602 4.38363 12.4998 3.69464 11.9194 3.11427C11.3391 2.53391 10.6501 2.07354 9.89178 1.75944C9.13349 1.44535 8.32076 1.28369 7.5 1.28369ZM7.5 12.5337C6.5111 12.5337 5.5444 12.2404 4.72215 11.691C3.89991 11.1416 3.25904 10.3607 2.88061 9.44711C2.50217 8.53348 2.40315 7.52814 2.59608 6.55824C2.789 5.58834 3.26521 4.69742 3.96447 3.99816C4.66373 3.2989 5.55465 2.82269 6.52455 2.62977C7.49446 2.43684 8.49979 2.53586 9.41342 2.91429C10.3271 3.29273 11.1079 3.93359 11.6574 4.75584C12.2068 5.57809 12.5 6.54479 12.5 7.53369C12.5 8.85977 11.9732 10.1315 11.0355 11.0692C10.0979 12.0069 8.82609 12.5337 7.5 12.5337Z" fill="white"/>
                  <path d="M12.5 7.53369L13.75 7.53369C13.75 6.71293 13.5883 5.9002 13.2742 5.14192C12.9602 4.38363 12.4998 3.69464 11.9194 3.11427C11.3391 2.53391 10.6501 2.07354 9.89177 1.75944C9.13349 1.44535 8.32076 1.28369 7.5 1.28369V2.53369C8.82608 2.53369 10.0979 3.06048 11.0355 3.99816C11.9732 4.93584 12.5 6.20761 12.5 7.53369Z" fill="white"/>
                </svg>
              </button>
                  </g>
                  <defs>
                    <clipPath id="clip0_connect_icon">
                      <rect width="15" height="15" fill="white" transform="translate(0 0.0332031)"/>
                    </clipPath>
                  </defs>
                </svg>
              </button>
              <button type="button" class="edit-btn" (click)="editPlatform(p)" [attr.aria-label]="'Edit ' + p.name + ' details'">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5Z"/></svg>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: Collaborations -->
      <div *ngIf="activeStep===2" class="collab-step">
        <form [formGroup]="collabForm" class="collab-grid" (ngSubmit)="next()">
          <div class="brand-column">
            <div class="brand-upload" (click)="triggerBrandFile()" role="button" tabindex="0" (keydown.enter)="triggerBrandFile()" aria-label="Add brand logo">
              <ng-container *ngIf="!brandLogoPreview; else logoPrev">
                <div class="placeholder-icon" aria-hidden="true">
                  <svg width="100" height="100" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
<ellipse opacity="0.1" cx="50" cy="97" rx="50" ry="3" fill="#ABABAB"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M76.4199 11.7742C76.4199 10.3192 77.5995 9.13965 79.0545 9.13965C80.5096 9.13965 81.6891 10.3192 81.6891 11.7742V17.1941C81.6891 18.6491 80.5096 19.8286 79.0545 19.8286C77.5995 19.8286 76.4199 18.6491 76.4199 17.1941V11.7742ZM79.0545 11.1396C78.704 11.1396 78.4199 11.4238 78.4199 11.7742V17.1941C78.4199 17.5445 78.704 17.8286 79.0545 17.8286C79.405 17.8286 79.6891 17.5445 79.6891 17.1941V11.7742C79.6891 11.4238 79.405 11.1396 79.0545 11.1396ZM20 29C20 24.0294 24.0294 20 29 20H71C75.9706 20 80 24.0294 80 29V62.3222C86.2904 63.6955 91 69.2978 91 76C91 83.732 84.732 90 77 90C70.658 90 65.3009 85.783 63.5798 80H29C24.0294 80 20 75.9706 20 71V29ZM63.1418 78C63.0483 77.3468 63 76.679 63 76C63 72.0826 64.6089 68.541 67.202 66H32C28.6863 66 26 63.3137 26 60V32C26 28.6863 28.6863 26 32 26H68C71.3137 26 74 28.6863 74 32V60C74 60.8712 73.8143 61.6991 73.4804 62.4461C74.6049 62.1549 75.7844 62 77 62C77.3362 62 77.6697 62.0119 78 62.0352V29C78 25.134 74.866 22 71 22H29C25.134 22 22 25.134 22 29V71C22 74.866 25.134 78 29 78H63.1418ZM32 28C29.7909 28 28 29.7909 28 32V54.3844L35.691 46.4469C38.0485 44.0138 41.9515 44.0138 44.309 46.4469L51.1407 53.4975C52.2005 54.5913 53.9118 54.7174 55.1205 53.7907L59.3494 50.5485C61.5031 48.8974 64.4969 48.8974 66.6506 50.5485L72 54.6497V32C72 29.7909 70.2091 28 68 28H32ZM60.6834 42.6296C60.6834 44.9307 58.8231 46.7962 56.5282 46.7962C54.2334 46.7962 52.373 44.9307 52.373 42.6296C52.373 40.3284 54.2334 38.4629 56.5282 38.4629C58.8231 38.4629 60.6834 40.3284 60.6834 42.6296ZM82.1533 22.6346C82.1533 21.1795 83.3329 20 84.7879 20H90.2077C91.6628 20 92.8423 21.1795 92.8423 22.6346C92.8423 24.0896 91.6628 25.2692 90.2077 25.2692H84.7879C83.3329 25.2692 82.1533 24.0896 82.1533 22.6346ZM84.7879 22C84.4374 22 84.1533 22.2841 84.1533 22.6346C84.1533 22.9851 84.4374 23.2692 84.7879 23.2692H90.2077C90.5582 23.2692 90.8423 22.9851 90.8423 22.6346C90.8423 22.2841 90.5582 22 90.2077 22H84.7879ZM65 76C65 69.3726 70.3726 64 77 64C83.6274 64 89 69.3726 89 76C89 82.6274 83.6274 88 77 88C70.3726 88 65 82.6274 65 76ZM74.5 69.5C74.5 68.1193 75.6193 67 77 67C78.3807 67 79.5 68.1193 79.5 69.5V75.5C79.5 76.8807 78.3807 78 77 78C75.6193 78 74.5 76.8807 74.5 75.5V69.5ZM77 69C76.7239 69 76.5 69.2239 76.5 69.5V75.5C76.5 75.7761 76.7239 76 77 76C77.2761 76 77.5 75.7761 77.5 75.5V69.5C77.5 69.2239 77.2761 69 77 69ZM77 85C75.6193 85 74.5 83.8807 74.5 82.5C74.5 81.1193 75.6193 80 77 80C78.3807 80 79.5 81.1193 79.5 82.5C79.5 83.8807 78.3807 85 77 85ZM76.5 82.5C76.5 82.7762 76.7239 83 77 83C77.2761 83 77.5 82.7762 77.5 82.5C77.5 82.2239 77.2761 82 77 82C76.7239 82 76.5 82.2239 76.5 82.5Z" fill="#ABABAB"/>
</svg>
                </div>
                <button type="button" class="add-logo-btn">Add Brand Logo</button>
              </ng-container>
              <ng-template #logoPrev>
                <img [src]="brandLogoPreview" alt="Brand logo preview" class="logo-preview"/>
                <button type="button" class="change-logo-btn">Change Logo</button>
              </ng-template>
              <input #brandFile type="file" accept="image/*" (change)="onBrandLogoSelected($event)" hidden />
            </div>
            <label class="field brand-select-wrapper">
              <span>Select Brands *</span>
              <small class="sub">Add your previous brand collaborations</small>
              <div class="dropdown" [class.open]="openBrands">
                <div class="input-icon" (click)="toggleBrands()">
                  <input formControlName="brand" type="text" placeholder="Select brand" readonly />
                  <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m6 9 6 6 6-6"/></svg>
                  
                </div>
                <ul class="dropdown-panel" *ngIf="openBrands">
                  <li *ngFor="let b of brandList" (mousedown)="selectBrand(b)">{{ b }}</li>
                </ul>
              </div>
            </label>
          </div>
          <div class="form-column">
            <label class="field">
              <span>Campaign Name *</span>
              <input formControlName="campaignName" type="text" placeholder="What did you call this campaign?" />
              <small class="err" *ngIf="submitted && collabForm.controls.campaignName.invalid">Required</small>
            </label>
            <label class="field">
              <span>Campaign Description *</span>
              <textarea formControlName="campaignDescription" rows="3" placeholder="Briefly describe this campaign"></textarea>
              <small class="err" *ngIf="submitted && collabForm.controls.campaignDescription.invalid">Required</small>
            </label>
            <label class="field">
              <span>Campaign Reach</span>
              <input formControlName="campaignReach" type="text" placeholder="What is the total audiences amounted ?" />
            </label>
            <label class="field">
              <span>Campaign Engagement</span>
              <input formControlName="campaignEngagement" type="text" placeholder="How many audience interacted with your campaign ?" />
            </label>
          </div>
        </form>
      </div>

      <!-- Step 4: Rates & Services -->
      <div *ngIf="activeStep===3" class="rates-step">
        <form class="rates-layout" [formGroup]="ratesForm" novalidate>
          <div class="services-left">
            <h3 class="section-sub">Choose Services Offered</h3>
            <div class="services-grid" role="list">
        <div *ngFor="let s of servicesList" class="service-card" role="checkbox" tabindex="0"
          [class.selected]="isServiceSelected(s.id)" [attr.aria-checked]="isServiceSelected(s.id)"
                   (click)="toggleService(s.id)" (keydown.enter)="toggleService(s.id)">
                <div class="card-head">
                  <span class="check" aria-hidden="true">
                    <svg *ngIf="isServiceSelected(s.id)" width="10" height="10" viewBox="0 0 12 12" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6.5 5.2 9 9 3"/></svg>
                  </span>
                  <span class="title">{{ s.title }}</span>
                </div>
                <p class="desc">{{ s.desc }}</p>
              </div>
            </div>
          </div>
          <div class="rates-right">
            <h3 class="section-sub">Select Charging Rate</h3>
            <ul class="rate-options" role="radiogroup" aria-label="Charging rate">
              <li *ngFor="let r of chargingRates" (click)="selectChargingRate(r.id)" (keydown.enter)="selectChargingRate(r.id)" role="radio" tabindex="0" [attr.aria-checked]="ratesForm.value.chargingRate===r.id">
                <span class="radio-box" [class.on]="ratesForm.value.chargingRate===r.id">
                  <svg *ngIf="ratesForm.value.chargingRate===r.id" width="9" height="9" viewBox="0 0 12 12" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 6.5 5.2 9 9 3" />
                  </svg>
                </span>
                <span class="label">{{ r.label }}</span>
              </li>
            </ul>
            <div class="enter-amount-block">
              <h4 class="amount-head">Enter Amount</h4>
              <div class="amount-row">
        <label class="currency dropdown" [class.open]="openCurrency">
                <div class="input-icon" (click)="toggleCurrency()">
          <input type="text" formControlName="currency" readonly />
                  <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m6 9 6 6 6-6"/></svg>
                </div>
                <ul class="dropdown-panel" *ngIf="openCurrency">
                  <li *ngFor="let c of currencyList" (mousedown)="selectCurrency(c)">{{ c }}</li>
                </ul>
              </label>
              <label class="field amount-field">
                <input type="text" formControlName="amount" placeholder="0.00" />
              </label>
              </div>
            </div>
          </div>
    </form>
      </div>

      <!-- Step 5: Contact Info -->
  <div *ngIf="activeStep===4" class="contact-step contact-info-step">
        <form [formGroup]="contactForm" class="form-grid" novalidate>
          <!-- Left Column -->
          <label class="field">
            <span>Email Address *</span>
            <input formControlName="email" type="email" placeholder="Enter your active email address" />
            <small class="err" *ngIf="submitted && contactForm.controls.email.invalid">Required</small>
          </label>
          <label class="field">
            <span>Booking Availability *</span>
            <div class="dropdown" [class.open]="openBookingAvailability">
              <div class="input-icon" (click)="toggleBookingAvailability()">
                <input formControlName="bookingAvailability" type="text" placeholder="When are you typically available for bookings?" readonly />
                <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m6 9 6 6 6-6"/></svg>
              </div>
              <ul class="dropdown-panel" *ngIf="openBookingAvailability">
                <li *ngFor="let opt of bookingAvailabilityOptions" (mousedown)="selectBookingAvailability(opt)">{{ opt }}</li>
              </ul>
            </div>
            <small class="err" *ngIf="submitted && contactForm.controls.bookingAvailability.invalid">Required</small>
          </label>
          <label class="field">
            <span>Phone Number *</span>
            <input formControlName="phone" type="text" placeholder="Add your phone contact number" />
            <small class="err" *ngIf="submitted && contactForm.controls.phone.invalid">Required</small>
          </label>
          <label class="field">
            <span>Socials Account</span>
            <div class="dropdown" [class.open]="openSocialsAccount">
              <div class="input-icon" (click)="toggleSocialsAccount()">
                <input formControlName="socialsAccount" type="text" placeholder="Which social platforms do you actively use for collaborations?" readonly />
                <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m6 9 6 6 6-6"/></svg>
              </div>
              <ul class="dropdown-panel" *ngIf="openSocialsAccount">
                <li *ngFor="let s of socialsAccountOptions" (mousedown)="selectSocialsAccount(s)">{{ s }}</li>
              </ul>
            </div>
          </label>
          <label class="field">
            <span>WhatsApp Contact</span>
            <input formControlName="whatsapp" type="text" placeholder="Add your WhatsApp contact number" />
          </label>
          <label class="field">
            <span>Preferred Contact Method</span>
            <div class="dropdown" [class.open]="openPreferredContact">
              <div class="input-icon" (click)="togglePreferredContact()">
                <input formControlName="preferredMethod" type="text" placeholder="Select your most active contact method" readonly />
                <svg class="chevron" xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m6 9 6 6 6-6"/></svg>
              </div>
              <ul class="dropdown-panel" *ngIf="openPreferredContact">
                <li *ngFor="let m of preferredContactMethods" (mousedown)="selectPreferredContact(m)">{{ m }}</li>
              </ul>
            </div>
          </label>
          <label class="field">
            <span>Website/Booking Site</span>
            <input formControlName="website" type="text" placeholder="eg. www.jdbookings.com" />
          </label>
          <label class="field">
            <span>Additional Notes</span>
            <textarea formControlName="notes" rows="3" placeholder="Enter Text"></textarea>
          </label>
        </form>
      </div>
    
  <!-- Other steps placeholder (future not implemented) -->
  <div class="placeholder-step" *ngIf="activeStep>4 && activeStep<steps.length-1">
        <p class="placeholder-copy">Form fields for "{{ steps[activeStep].label }}" pending implementation.</p>
      </div>
  <!-- Reusable preview grid template -->
      <ng-template #previewGrid>
        <div class="preview-grid design-layout">
          <!-- Summary / Status Card -->
          <div class="preview-card summary-card area-summary">
            <div class="summary-inner">
              <div class="last-updated">
                <div class="label">Last Updated</div>
                <div class="time">12:00 PM | Apr,08</div>
              </div>
              <div class="divider-vert" aria-hidden="true"></div>
              <div class="status-section">
                <div class="status-line">
                  <span class="status-icon" aria-hidden="true">
                    <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6.5 5.2 9 9 3"/></svg>
                  </span>
                  <span class="status-label">Status: <strong>Finished</strong></span>
                </div>
                <!-- <div class="progress-line">{{ steps.length }}/{{ steps.length }} Completed</div> -->
                <div class="progress-line">7/7 Completed</div>
              </div>
              <button type="button" class="edit-kit-btn" (click)="jump(0)">Edit Kit</button>
            </div>
          </div>

          <!-- Previous Collaborations -->
          <div class="preview-card collabs-card area-collabs">
            <div class="card-head"><h3>Previous Collaborations</h3><a href="#" class="view-link" (click)="$event.preventDefault()">View all ▸</a></div>
            <ul class="collab-list">
              <li class="collab-item" *ngFor="let c of previewCollaborations | slice:0:3; let i = index">
                <div class="logo-box" [ngClass]="'logo-'+i" aria-hidden="true"></div>
                <div class="c-meta">
                  <div class="reach" *ngIf="c.reach">{{ c.reach }}</div>
                  <div class="title">{{ c.title }}</div>
                </div>
              </li>
              <li class="collab-item empty" *ngIf="(previewCollaborations?.length||0)===0">No collaborations added.</li>
            </ul>
          </div>

          <!-- Services & Rates -->
          <div class="preview-card services-card area-services">
            <div class="card-head"><h3>Services & Rates</h3><button type="button" class="icon-btn" (click)="jump(3)" aria-label="Edit Services & Rates"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5Z"/></svg></button></div>
            <div class="services-rates">
              <div class="svc-col">
                <div class="col-head">Services</div>
                <ul class="plain-list">
                  <ng-container *ngFor="let s of servicesList">
                    <li *ngIf="isServiceSelected(s.id)">{{ s.title }}</li>
                  </ng-container>
                  <li *ngIf="selectedServices.length===0" class="empty">—</li>
                </ul>
              </div>
              <div class="rate-col">
                <div class="col-head">Rates</div>
                <ul class="plain-list">
                  <li *ngIf="ratesForm.value.chargingRate==='negotiable'">Negotiable</li>
                  <!-- If a concrete amount entered show primary rate -->
                  <li *ngIf="ratesForm.value.chargingRate!=='negotiable' && amountValue">{{ ratesForm.value.currency }} {{ amountValue | number:'1.2-2' }} {{ readableRate(ratesForm.value.chargingRate || null) }}</li>
                  <!-- Provide a derived secondary rate example when user supplied amount (mirrors design having two lines) -->
                  <li *ngIf="amountValue && ratesForm.value.chargingRate==='per_post'">{{ ratesForm.value.currency }} {{ (amountValue * 15) | number:'1.2-2' }} per package</li>
                  <li *ngIf="amountValue && ratesForm.value.chargingRate==='per_package'">{{ ratesForm.value.currency }} {{ (amountValue / 15) | number:'1.2-2' }} per post</li>
                  <li *ngIf="!amountValue && ratesForm.value.chargingRate!=='negotiable'" class="empty">—</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Basic Info -->
          <div class="preview-card basic-card area-basic">
            <div class="card-head"><h3>Basic Info</h3><button type="button" class="icon-btn" (click)="jump(0)" aria-label="Edit Basic Info"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5Z"/></svg></button></div>
            <div class="profile-line">
              <div class="avatar small" aria-hidden="true">JD</div>
              <div class="person"><div class="name">{{ form.value.firstName }} {{ form.value.lastName }}</div><div class="role">Creator</div></div>
            </div>
            <div class="bio-label" *ngIf="form.value.bio">Bio</div>
            <div class="bio" *ngIf="form.value.bio">{{ form.value.bio }}</div>
            <dl class="kv">
              <div><dt>Location</dt><dd>{{ form.value.location || '—' }}</dd></div>
              <div><dt>Content Niche (s)</dt><dd>Tech Review</dd></div>
              <div><dt>Languages (s)</dt><dd>{{ form.value.languages || 'English' }}</dd></div>
              <div><dt>Stage Name</dt><dd>{{ form.value.alias || '—' }}</dd></div>
            </dl>
          </div>

          <!-- Contact Information -->
          <div class="preview-card contact-card area-contact">
            <div class="card-head"><h3>Contact Information</h3><button type="button" class="icon-btn" (click)="jump(4)" aria-label="Edit Contact Info"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5Z"/></svg></button></div>
            <dl class="kv tight">
              <div><dt>Email Address</dt><dd>{{ contactForm.value.email || '—' }}</dd></div>
              <div><dt>Phone Number (s)</dt><dd>{{ contactForm.value.phone || '—' }}</dd></div>
              <div><dt>Website/Booking site</dt><dd>
                <ng-container *ngIf="contactForm.value.website; else noSite">
                  <a class="site-link" href="{{ formatWebsite(contactForm.value.website) }}" target="_blank" rel="noopener">{{ contactForm.value.website }}</a>
                </ng-container>
                <ng-template #noSite>—</ng-template>
              </dd></div>
              <div><dt>Booking Availability</dt><dd>{{ contactForm.value.bookingAvailability || '—' }}</dd></div>
              <div><dt>Preferred Contact Method</dt><dd>{{ preferredContactDisplay() || '—' }}</dd></div>
              <div *ngIf="contactForm.value.whatsapp"><dt>WhatsApp Contact</dt><dd>{{ contactForm.value.whatsapp }}</dd></div>
              <div><dt>Additional Notes</dt><dd>{{ contactForm.value.notes || '—' }}</dd></div>
            </dl>
          </div>

          <!-- Socials & Stat -->
          <div class="preview-card socials-card area-socials">
            <div class="card-head"><h3>Socials & Stat</h3><button type="button" class="icon-btn" (click)="jump(1)" aria-label="Edit Socials"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5Z"/></svg></button></div>
            <ul class="platform-stats alt">
              <li *ngFor="let p of platforms | slice:0:8" [class.connected]="p.connected">
                <span class="icon" [innerHTML]="p.icon" aria-hidden="true"></span>
                <div class="info">
                  <div class="top-line">
                    <span class="pname">{{ p.name }}</span>
                    <span class="ext" aria-hidden="true"><svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><path d="m15 3 6 6M21 3h-6v6"/></svg></span>
                  </div>
                  <div class="metric" *ngIf="p.connected; else dash">{{ platformMetrics[p.id] || '—' }}</div>
                  <ng-template #dash><div class="metric empty">—</div></ng-template>
                </div>
              </li>
            </ul>
          </div>

          <!-- Top Content -->
          <div class="preview-card content-card area-topcontent">
            <div class="card-head"><h3>Top Content</h3><a href="#" class="view-link" (click)="$event.preventDefault()">View all ▸</a></div>
            <div class="top-content-grid precise">
              <!-- First row: 3 thumbs -->
              <ng-container *ngFor="let c of topContents | slice:0:3; let i=index">
                <div class="content-thumb" [ngClass]="'c-'+i"></div>
              </ng-container>
              <!-- Second row: next single thumb in column 1 -->
              <div class="content-thumb second-row" *ngIf="topContents.length>3" [ngClass]="'c-3'"></div>
              <div class="add-contents" (click)="addContent()">+ Add Contents</div>
            </div>
          </div>
        </div>
      </ng-template>

  <div class="preview-pane" *ngIf="activeStep===steps.length-1">
        <ng-container [ngTemplateOutlet]="previewGrid"></ng-container>
      </div>

      <!-- Actions (now always visible, with Save Media Kit on preview step) -->
      <div class="actions">
        <button type="button" class="back" [disabled]="activeStep===0" (click)="prev()"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m15 18-6-6 6-6"/></svg> Back</button>
        <button type="button" class="save" (click)="saveDraft()" *ngIf="activeStep < steps.length-1">Save For Later</button>
        <button type="button" class="next" (click)="next()" *ngIf="activeStep < steps.length-1">Next <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="m9 6 6 6-6 6"/></svg></button>
        <button type="button" class="next" *ngIf="activeStep === steps.length-1" (click)="finish()">Save Media Kit</button>
      </div>
    </div>
  </div>

  <!-- Modal removed; navigation used instead -->